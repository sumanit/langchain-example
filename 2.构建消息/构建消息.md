# 使用消息
在lagnchain中内置了多种角色的消息 分别为 
- 系统消息 SystemMessage
- 用户消息 HumanMessage
- 模型消息 AIMessage
- 方法消息 FunctionMessage
- 工具消息 ToolMessage

langchain也提供了自定义角色类型的消息 ChatMessage

如果我们的消息是固定的，不需要进行prompt的占位符替换，可以直接通过初始化消息类的方式进行初始化

```python
from langchain_core.messages import SystemMessage, AIMessage, HumanMessage, ChatMessage
from langchain_core.prompts import ChatPromptTemplate

system_message = SystemMessage("你是一唐朝的诗人。")
human_message = HumanMessage("请做一个关于春天的五言绝句诗。")
ai_message = AIMessage("春眠不觉晓，处处闻啼鸟。")  # 初始AI响应分块
chat_message = ChatMessage(
    role="system",
    content="你好"
)
prompt = ChatPromptTemplate.from_messages( [
    system_message,
    human_message,
    ai_message,
    chat_message
])
```



## 类继承关系

Message类继承关系如下
```
BaseMessage 基类
 +-- SystemMessage     系统消息
 +-- HumanMessage      用户消息
 +-- AIMessage         模型回复消息
 +-- ChatMessage       通用消息
 +-- FunctionMessage   
 +-- ToolMessage       
 +-- BaseMessageChunk  
      +-- SystemMessageChunk
      +-- AIMessageChunk
      +-- HumanMessageChunk
      +-- ChatMessageChunk
      +-- FunctionMessageChunk
      +-- ToolMessageChunk
```



# 使用模板

如果prompt里有一些动态参数需要进行替换就可以使用模板来构建消息

```python
from langchain_core.prompts import ChatPromptTemplate,SystemMessagePromptTemplate,HumanMessagePromptTemplate,AIMessagePromptTemplate,ChatMessagePromptTemplate

system_msg = SystemMessagePromptTemplate.from_template("你是一个{role}。")
user_msg = HumanMessagePromptTemplate.from_template("请做一个关于{theme}的五言绝句诗。")
ai_msg = AIMessagePromptTemplate.from_template("春眠不觉晓，处处闻啼鸟。夜来风雨声，花落知多少。")
user_msg2 = ChatMessagePromptTemplate.from_template(
    role="user",
    template="还不够 再来一首"  # 使用 theme 变量
)
prompt = ChatPromptTemplate.from_messages([system_msg, user_msg, ai_msg, user_msg2])
```


## 类继承关系

```
BaseMessagePromptTemplate 基类
 +-- _StringImageMessagePromptTemplate 
      +-- AIMessagePromptTemplate      生成 AIMessage
      +-- HumanMessagePromptTemplate   生成 HumanMessage
      +-- SystemMessagePromptTemplate  生成 SystemMessage
 +-- BaseStringMessagePromptTemplate
      +-- ChatMessagePromptTemplate    生成 ChatMessage
 +-- MessagesPlaceholder               消息占位符 注意 是s复数 所以返回的是BaseMessage 列表
```


 
